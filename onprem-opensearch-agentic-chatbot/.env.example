# =========================
# App (Node.js backend)
# =========================
APP_PORT=3000
APP_CORS_ORIGIN=*

# =========================
# LLM (OpenAI-compatible)
# =========================
LLM_BASE_URL=http://localhost:8000/v1
LLM_API_KEY=
LLM_MODEL=qwen2.5-7b-instruct

# JSON mode (some servers support response_format)
LLM_JSON_MODE=false

# Generation params
LLM_TEMPERATURE=0.2
LLM_MAX_TOKENS=700

# =========================
# Embeddings
# =========================
# If you do NOT have an embeddings endpoint, set to false.
EMBEDDINGS_ENABLED=true
EMBEDDING_BASE_URL=${LLM_BASE_URL}
EMBEDDING_API_KEY=${LLM_API_KEY}
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIM=768

# Cache embeddings in-memory
EMBEDDING_CACHE_SIZE=2000

# =========================
# OpenSearch
# =========================
OPENSEARCH_NODE=http://localhost:9200
OPENSEARCH_INDEX=docs_index

# auth modes: none | basic | apikey
OPENSEARCH_AUTH_MODE=none
OPENSEARCH_USERNAME=
OPENSEARCH_PASSWORD=
# API key (if OPENSEARCH_AUTH_MODE=apikey)
OPENSEARCH_API_KEY=
OPENSEARCH_API_KEY_HEADER=Authorization
OPENSEARCH_API_KEY_PREFIX=ApiKey

# SSL (set false if using self-signed cert)
OPENSEARCH_SSL_REJECT_UNAUTHORIZED=false

# fields
OPENSEARCH_VECTOR_FIELD=embedding
OPENSEARCH_SOURCE_FIELDS=doc_id,title,content,chunk_id,source,updated_at,url

# BM25 keyword fields (boost title higher)
OPENSEARCH_KEYWORD_FIELDS=title^3,title.keyword^6,content

# kNN params
KNN_NUM_CANDIDATES=200

# =========================
# Retrieval
# =========================
TOP_N=8
SUBQUERY_SIZE=20
RRF_K=60

# Evidence check
EVIDENCE_MIN_HITS=2
EVIDENCE_MIN_TOKEN_MATCHES=2
ALLOW_REFINE=true

# Chunk content cap sent to LLM (characters)
CHUNK_CONTENT_MAX_CHARS=1400
